# יומן שינויים - Fish Stock Management System

## [1.10.0] - 2025-12-23

### תכונות חדשות ✨
- **העברה מיידית מתוך תכנון העברות**: כעת ניתן לבצע העברת דגים מיידית מתוך מסך תכנון ההעברות
  - צ'ק-בוקס חדש "✓ העברה בוצעה (עדכון מיידי)" בשלב 3
  - כשמסומן: ההעברה מבוצעת מיד ללא יצירת תוכנית
  - כשלא מסומן: ההתנהגות הרגילה - הוספה לתוכנית העברות
  - מתאים למצבים שבהם העברה כבר בוצעה פיזית ורק צריך לעדכן במערכת
  - הצ'ק-בוקס מוצג רק עבור העברות רגילות (לא משלוח)
  - לאחר ביצוע מיידי, המערכת חוזרת לשלב 1 ומטעינה מחדש את הנתונים

### שיפורים 🔧
- כפתור "הוסף למשימות" משתנה ל-"✓ בצע העברה" כשהצ'ק-בוקס מסומן
- הודעת הצלחה ברורה לאחר ביצוע העברה מיידית
- אפילו אם firestore.rules עדיין לא פורסם, ניתן לבצע העברות מיידיות

---

## [1.9.0] - 2025-12-23

### תיקוני באגים 🐛
- **תוקן: שגיאת הרשאות Firebase**: נוספו הרשאות ל-`transfer_plans` ב-firestore.rules
  - חסר היה הגדרת הרשאות לקולקציות transfer_plans ו-tasks
  - משתמשי חווה כעת יכולים ליצור ולנהל תוכניות העברה

### שיפורים 🔧
- **תצוגת דגים ברשימת אקווריומים (שלב 1)**: כעת רואים את כל הדגים שבאקווריום עוד לפני הבחירה
  - רשימת הדגים מוצגת ישירות בכרטיס האקווריום
  - כל דג מוצג עם: שם עברי, כמות וגודל
  - טעינה מהירה יותר - כל הדגים נטענים מראש
  - לא צריך ללחוץ על אקווריום כדי לראות מה בתוכו

---

## [1.8.0] - 2025-12-22

### תכונות חדשות ✨
- **שיפורים למערכת תכנון העברות**:
  - **סינון לפי אזורים** 📍: אפשרות לסנן אקווריומי מקור ויעד לפי אזורים/חדרים
    - סינון נפרד לאקווריום מקור (שלב 1)
    - סינון נפרד לאקווריום יעד (שלב 3)
    - מציג רק אקווריומים מהאזור הנבחר
  - **העברה למשלוח** 📦: אפשרות חדשה לסמן העברות כאריזה למשלוח
    - תיבת סימון בולטת בצבע כתום
    - במקום לבחור אקווריום יעד, מסמנים "העברה למשלוח"
    - העובד מקבל הוראה ברורה לארוז את הדגים
    - מוצג בממשק הביצוע עם אייקון 📦 משלוח
  - **הערות בולטות** 📝: שדה הערות משודרג ובולט יותר
    - הומר מ-input ל-textarea עם 3 שורות
    - רקע סגול בולט עם מסגרת
    - דוגמאות בתוך ה-placeholder: "לארוז מחר בבוקר", "לנקות פילטר אחרי פינוי", "להחליף מים אחרי פינוי"
    - הערות מוצגות בצורה בולטת גם בסיכום המשימות וגם בממשק הביצוע

### שיפורים 🔧
- תצוגה משופרת של משימות משלוח בכל הממשקים
- הערות מוצגות בקופסא סגולה בולטת במקום טקסט קטן
- חוויית משתמש משופרת עם סינון אזורים

---

## [1.7.0] - 2025-12-22

### תכונות חדשות ✨
- **מערכת תכנון וביצוע העברות**: מערכת מתקדמת לתכנון וביצוע העברות דגים
  - **תכנון העברות** (TransferPlanModal): יצירת תוכניות העברה עם מספר משימות
    - בחירת אקווריום מקור → בחירת דג → בחירת אקווריום יעד
    - הוספת מספר משימות לתוכנית אחת
    - בדיקת התנגשויות והתראות אוטומטיות
    - תמיכה בשרשור (emptying aquarium A, then filling A)
    - מעקב אחר משימות שנוספו
  - **ביצוע העברות** (TransferExecutionModal): ביצוע תוכניות בפועל
    - רשימת משימות ממוינת לפי סדר ביצוע
    - כפתורים: "בוצע ✓" ו-"תקוע ⚠️"
    - progress bar להתקדמות
    - מעקב אחר משימות שבוצעו, חסומות, ובוטלו
  - **התראות חכמות** (WarningDialog): זיהוי התנגשויות
    - אקווריום מתוכנן להתרוקן
    - אקווריום מתוכנן לקבל דגים
    - אקווריום תפוס (עם אפשרות mixing)
  - **דיווח תקלות** (BlockReportDialog): מנגנון דיווח וחסימה
    - 4 סוגי תקלות: טמפרטורה, גודל אקווריום, דליפה, אחר
    - שדה הערות חופשי
    - התראה למנהל
    - אפשרות למנהל להמשיך או לבטל משימה
  - **2 כפתורים חדשים בדף הבית**:
    - 📝 תכנון העברות
    - ▶️ ביצוע העברות

### שיפורים 🔧
- מצב וירטואלי של אקווריומים - מעקב אחר מצב עתידי לפי התוכנית
- סדר ביצוע קבוע למשימות - מונע טעויות
- תמיכה בהרשאות מנהל לאישור חסימות

---

## [1.6.2] - 2025-12-21

### תיקוני באגים 🐛
- **תוקן מודל העברת דגים**: תוקנה הבעיה שגרמה להצגת "אין דגים באקווריום זה" עבור אקווריומים מאוכלסים
  - עודכן `transfer.service.js` לעבוד עם המבנה החדש של `farmFish` במקום המבנה הישן
  - פונקציה `getFishInAquarium` עודכנה לסנן דגים לפי `aquariumId`
  - פונקציה `transferFish` עודכנה לעבוד ישירות עם קולקציית `farmFish`

### שיפורים 🔧
- **שיפור עיצוב מודל העברת דגים**: המודל כעת מסודר יותר עם גלילה נכונה
  - אזור התוכן מתגלגל בנפרד מהכותרת והכפתורים
  - הכפתורים תמיד נראים בתחתית המודל
  - חוויית משתמש משופרת עם רשימות ארוכות של אקווריומים

---

## [1.6.1] - 2025-12-19

### שיפורים 🔧
- **השלמה אוטומטית לשמות דגים**: נוסף autocomplete לשדות הקלדת פרטי דגים
  - השלמה אוטומטית לשם עברי - על בסיס דגים קודמים
  - השלמה אוטומטית לשם מדעי - מתעדכן אוטומטית בעת בחירת שם עברי מוכר
  - מושך נתונים גם מפריטי קליטה (reception_items) וגם מדגי החווה (farmFish)
  - הדגים הפופולריים ביותר מופיעים ראשונים ברשימה
- פישוט של פונקציית `getPreviousFishNames` - מתמקדת רק בשמות ללא מעקב אחר גדלים

### תיקוני באגים 🐛
- **תוקן מיון רשימות אקווריומים**: מיון מספרי תקין (1, 2, 3... 10, 11) במקום מיון טקסטואלי (1, 10, 11... 2, 20)
  - תוקן ב-`getAquariums`, `getEmptyAquariums`, `getAquariumsByRoom`
  - המיון מבוצע בצד הלקוח לאחר קבלת הנתונים מ-Firestore

---

## [1.6.0] - 2025-12-19

### שינויים משמעותיים 🚀
- **ניהול דגים מתוך כרטיס האקווריום**: כעת ניתן להוסיף ולערוך דגים ישירות מכרטיס האקווריום
  - כפתור **"➕ הוסף דג"** באקווריומים ריקים - מוסיף דג חדש ישירות לאקווריום
  - כפתור **"🐠 ערוך דגים"** באקווריומים תפוסים - לניהול הדגים הקיימים
  - חוסך לחיצת כפתור - פשוט יותר ומהיר יותר!

### תכונות חדשות ✨
- **מסך ניהול דגים לאקווריום** (AquariumFishModal):
  - הוספת דג חדש ישירות לאקווריום
  - עריכת כמויות דגים קיימים
  - מחיקת דגים
  - תצוגה ברורה של כל הדגים באקווריום
  - תמיכה במספר מינים באותו אקווריום

### שיפורים 🔧
- **הסרת "דגים לאקווריום"**: מחקנו את הקטגוריה המבלבלת
  - אין יותר מושג של "דגים לא משויכים"
  - כל דג חייב להיות משוייך לאקווריום מרגע היצירה
  - זרימת עבודה הרבה יותר הגיונית
- עדכון `farm-fish.service`: תמיכה בעדכון דגים והקצאה ישירה לאקווריום
- תיקון `.env.example`: שימוש ב-`VITE_` במקום `REACT_APP_`

### הסרות 🗑️
- הוסר FarmFishModal ממסך הבית
- הוסר הכפתור "דגים לאקווריום" מדף הבית

---

## [1.2.0] - 2025-12-09

### תכונות חדשות ✨
- **מערכת קליטת דגים (Reception System)**: מערכת מלאה לתכנון וקבלת משלוחי דגים
  - **תוכנית קליטה**: יצירה וניהול של תוכניות קליטה עם תאריך צפוי ואסמכתה
  - **איכלוס ידני**: הוספה ידנית של דגים לתוכנית עם:
    - בחירת חדר/אזור
    - בחירת אקווריום יעד
    - הזנת פרטי הדג (שם עברי, שם מדעי, גודל, מספר ארגז, קוד)
  - **קבלת דגים**: ממשק לקבלה פיזית של דגים עם:
    - רשימת דגים ממתינים לקבלה
    - קופסאות בחירה לסימון קבלה
    - הוספה אוטומטית של דגים לאקווריום בעת סימון קבלה
    - מעקב התקדמות בגרף
  - תצוגת תוכניות קליטה עם סינון לפי סטטוס
  - ניהול כל התוכניות מדף הבית
  - הכנה לאינטגרציה עם ייבוא Excel בשלב הבא

### שיפורים 🔧
- אפשרות חדשה בעמוד הבית: כפתור "איכלוס אקווריומים" (🏠)
- עדכון מודל fish_instances עם גודל, קוד, וריכוז עזור בעת קבלה
- מעקב מלא של אחוז הקבלה בתוכניות

---

## [1.1.2] - 2025-12-07

### שיפורים 🔧
- **סקריפט אוטומטי לעדכון גרסאות**: נוסף סקריפט שמעדכן את כל קבצי הגרסה בפקודה אחת
  - `npm run version:patch` - תיקון באג (1.0.0 → 1.0.1)
  - `npm run version:minor` - תכונה חדשה (1.0.0 → 1.1.0)
  - `npm run version:major` - שינוי משמעותי (1.0.0 → 2.0.0)
  - מעדכן אוטומטית: package.json, src/version.js, תאריך
  - מזכיר לעדכן את CHANGELOG.md
  - מונע שכחת עדכון גרסה

---

## [1.1.1] - 2025-12-07

### תיקוני באגים 🐛
- תוקן: שגיאת `ReferenceError: setShowNewRoomInput is not defined` ביצירת אקווריום
  - הוסרו הפניות למשתני state שנמחקו בגרסה קודמת

---

## [1.1.0] - 2025-12-07

### תכונות חדשות ✨
- **מערכת העברת דגים**: מערכת מלאה להעברת דגים בין אקווריומים
  - ממשק 3 שלבים: בחירת מקור → בחירת דג וכמות → בחירת יעד
  - סינון לפי חדרים
  - מעקב אחר כמויות ועדכון אוטומטי של סטטוס האקווריומים
  - זמין מדף הבית, עמוד האקווריומים, ומודל עריכה

- **ניהול מיקומים משופר**: דף הגדרות מרכזי לניהול מיקומים
  - הוספה, עריכה ומחיקה של מיקומים
  - מניעת מחיקת מיקומים בשימוש
  - תצוגת מספר אקווריומים לכל מיקום
  - קישור ישיר מטפסי האקווריומים לדף ניהול המיקומים

### תיקוני באגים 🐛
- תוקן: שמירת מיקומים חדשים במסד הנתונים
- תוקן: שגיאת `TypeError: r is not a function` בדף ההגדרות
- תוקן: סדר ה-spread במיגרציה של הגדרות החווה (מונע דריסת ערכים)

### שיפורים 🔧
- הוסר קוד מיותר (206 שורות הוסרו, 58 נוספו)
- ממשק פשוט יותר לניהול מיקומים
- הודעות שגיאה מפורטות יותר
- עדכון React ל-19.2.1 (תיקון אבטחה CVE-2025-55182)

---

## [1.0.0] - 2025-12-06

### שחרור ראשוני 🎉
- מערכת ניהול חוות דגים מבוססת Firebase
- אימות משתמשים עם Google Sign-In
- ניהול אקווריומים (הוספה, עריכה, מחיקה)
- ייבוא משלוחים מקבצי Excel
- ניהול מלאי דגים
- ממשק בעברית
- תמיכה ב-PWA
